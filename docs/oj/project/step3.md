## Step 3：用户系统与提交频控

---

### 模块目标

实现多用户管理、权限控制与提交频率限制。

---

### 前置知识要求

| 技术点         | 推荐学习内容           |
| -------------- | ---------------------- |
| 字典与列表结构设计 | 管理用户信息：`Dict[int, User]` |
| 时间操作        | `datetime.datetime` 判断日期 |
| API接口设计     | FastAPI/Flask 路由与状态码 |
| 状态持久化      | JSON/SQLite 存储用户数据 |

---

### 任务拆解

#### 任务 1：用户注册/查询/更新
- 目标：支持用户注册、信息更新与查询。
- 要点：用户ID唯一，支持更新username/role，系统启动自动创建root用户。
- 建议：数据结构包含id、username、role、submit_quota、stats。

#### 任务 2：提交频率限制与权限控制
- 目标：限制普通用户每日提交次数，实现user/admin/banned三种角色权限。
- 要点：每次提交前检查当天提交次数，超限返回429，banned禁止提交。
- 建议：用户结构包含submit_history，接口访问前校验角色权限。

#### 任务 3：人工评测接口（仅限admin）
- 目标：管理员可手动修改任务评测状态。
- 要点：仅admin可用，需记录变更日志。
- 建议：日志结构包含操作人、时间、前后状态、备注。

---

### 能力小结

| 能力项         | 说明                       |
| -------------- | -------------------------- |
| 用户注册/更新   | 支持用户信息注册与修改     |
| 权限系统       | 支持user/admin/banned角色  |
| 提交频控       | 每日限额，防止资源滥用     |
| 人工判题       | 管理员可手动修改评测状态   |
| 优先级调度     | 任务调度支持角色优先级     |