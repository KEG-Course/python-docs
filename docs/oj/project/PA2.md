# PA2: Online Judge 系统设计与实现

## 项目概述

本项目旨在构建一个功能完整的 Online Judge (OJ) 系统，为学生提供在线编程评测平台。通过分阶段实现，学生将掌握系统设计、API开发、并发处理、安全控制等核心技能。

### 项目目标

> 构建一个小型但功能完整的 Online Judge 评测服务 (OJ Server)

```
      +-----------+          +------------+         +--------------+
用户   | 提交代码  |  POST →  | OJ 服务器   |  → Run →| 评测结果     |
      +-----------+          |            |         +--------------+
                                  ↓
                             任务队列
                                  ↓
                           任务状态管理
                                  ↓
                        用户查询任务状态 / 排行榜
```

## 学习目标

通过本项目的学习，学生将能够：

1. **掌握系统架构设计**：理解分布式系统的基本概念和设计原则
2. **熟练API开发**：使用FastAPI/Flask构建RESTful API
3. **理解并发编程**：掌握多线程、异步编程和任务调度
4. **学会安全控制**：实现用户权限管理和代码安全沙箱
5. **掌握数据处理**：使用数据库进行数据持久化和查询优化
6. **理解监控调试**：实现系统监控、日志记录和性能分析
7. **学会代码质量**：实现代码查重、质量评估和智能分析

## 项目模块

### 基础模块 (必做)

| 模块 | 名称 | 主要功能 | 技术要点 |
| ---- | ---- | -------- | -------- |
| Step 1 | 配置解析 + 语言支持 | 构建通用语言运行环境 | 配置文件解析、命令生成、语言自动识别 |
| Step 2 | 评测执行 + 正确判断 | 实现评测核心模块 | 子进程控制、资源限制、结果比对 |
| Step 3 | 用户系统 + 提交频控 | 多用户管理与权限控制 | 用户注册、角色权限、频率限制 |
| Step 4 | 任务管理与状态流转 | 完整的任务生命周期管理 | 状态机、任务调度、队列管理 |
| Step 5 | 排行榜机制 | 用户得分统计与排序 | 数据聚合、排序算法、分页查询 |

### 进阶模块 (选做)

| 模块 | 名称 | 主要功能 | 技术要点 |
| ---- | ---- | -------- | -------- |
| Advance 1 | 智能代码分析与LLM辅助评测 | LLM驱动的代码质量评估 | LLM API集成、代码分析、智能诊断 |
| Advance 2 | 分布式评测系统与高级安全 | 可扩展的分布式架构 | 分布式队列、安全沙箱、负载均衡 |
| Advance 3 | 高级调试工具与性能分析 | 强大的调试和分析能力 | 远程调试、性能监控、可视化分析 |
| Advance 4 | 智能题目管理与自动生成 | 智能化的题目管理 | 机器学习、知识图谱、自动生成 |
| Advance 5 | 智能代码查重系统 | 全面的代码查重检测 | 多维度分析、相似度计算、可视化报告 |

## 技术栈

### 后端技术
- **Web框架**: FastAPI / Flask
- **异步编程**: asyncio, aiohttp
- **数据库**: SQLite / PostgreSQL
- **缓存**: Redis
- **任务队列**: Celery / Redis Queue

### 系统编程
- **进程管理**: subprocess, multiprocessing
- **资源控制**: resource, cgroups
- **安全沙箱**: seccomp, namespaces
- **容器技术**: Docker

### 机器学习与AI
- **LLM集成**: OpenAI API, Claude API
- **代码分析**: ast, tree-sitter
- **向量数据库**: FAISS, ChromaDB
- **机器学习**: scikit-learn, numpy

### 监控与可视化
- **性能监控**: Prometheus, Grafana
- **日志系统**: ELK Stack
- **数据可视化**: matplotlib, plotly
- **调试工具**: DAP, pdb

## 项目特色

### 1. 渐进式学习
- 从基础功能开始，逐步增加复杂度
- 每个模块都有明确的学习目标和验收标准
- 支持选择性实现，适应不同学习进度

### 2. 工业级实践
- 采用真实项目中的技术栈和架构模式
- 重视代码质量、性能优化和系统可靠性
- 包含完整的测试、监控和部署方案

### 3. AI技术集成
- 集成大语言模型进行智能代码分析
- 使用机器学习进行题目难度评估
- 实现智能推荐和个性化学习路径

### 4. 分布式架构
- 支持多机器并行评测
- 实现负载均衡和故障转移
- 具备良好的可扩展性和容错能力

### 5. 安全与监控
- 多层安全防护机制
- 实时性能监控和告警
- 完整的审计日志和追踪系统

## 项目结构

```
python-pa2/
├── step1.md          # 配置解析与语言支持
├── step2.md          # 评测控制
├── step3.md          # 用户系统
├── step4.md          # 任务状态管理
├── step5.md          # 排行榜机制
├── advance1.md       # 智能代码分析
├── advance2.md       # 分布式评测系统
├── advance3.md       # 高级调试工具
├── advance4.md       # 智能题目管理
├── advance5.md       # 智能代码查重
├── examples/         # 示例代码
├── tests/           # 测试用例
└── docs/            # 项目文档
```

## 评估标准

### 基础模块 (60分)
- **Step 1-5**: 每个模块12分
- 功能完整性、代码质量、测试覆盖
- 文档完整性和API设计合理性

### 进阶模块 (40分)
- **Advance 1-5**: 每个模块8分
- 技术难度、创新性、实用性
- 系统设计和架构合理性

### 加分项
- 性能优化 (5分)
- 用户体验 (5分)
- 创新功能 (5分)
- 项目展示 (5分)

## 提交要求

### 代码提交
- 完整的源代码和配置文件
- 清晰的代码注释和文档
- 单元测试和集成测试
- 性能测试报告

### 文档提交
- 系统设计文档
- API接口文档
- 部署和运维文档
- 用户使用手册

### 演示要求
- 功能演示视频
- 系统架构展示
- 性能测试演示
- 问题解答

## 学习资源

### 官方文档
- [FastAPI 官方文档](https://fastapi.tiangolo.com/)
- [Python asyncio 文档](https://docs.python.org/3/library/asyncio.html)
- [Redis 官方文档](https://redis.io/documentation)

### 技术教程
- [系统设计基础](https://github.com/donnemartin/system-design-primer)
- [Python 并发编程](https://docs.python.org/3/library/concurrent.futures.html)
- [Docker 容器技术](https://docs.docker.com/)

### 参考项目
- [Codeforces](https://codeforces.com/) - 知名OJ平台
- [LeetCode](https://leetcode.com/) - 编程练习平台
- [HackerRank](https://www.hackerrank.com/) - 技术评测平台

## 常见问题

### Q: 如何选择进阶模块？
A: 建议根据自己的兴趣和技术基础选择1-2个进阶模块。如果对AI感兴趣，可以选择Advance 1；如果对系统架构感兴趣，可以选择Advance 2。

### Q: 项目难度如何？
A: 基础模块适合所有学生，进阶模块有一定挑战性。建议先完成基础模块，再尝试进阶功能。

### Q: 需要什么开发环境？
A: 需要Python 3.8+、Docker、Redis等。详细环境配置请参考各模块文档。

### Q: 如何获得帮助？
A: 可以查看模块文档、参考示例代码、参与讨论。遇到技术问题可以查阅官方文档或寻求助教帮助。

## 项目时间安排

| 阶段 | 时间 | 主要任务 |
| ---- | ---- | -------- |
| 第1周 | 环境搭建 | 开发环境配置、基础模块学习 |
| 第2-3周 | 基础开发 | Step 1-3 实现 |
| 第4-5周 | 核心功能 | Step 4-5 实现 |
| 第6-7周 | 进阶功能 | Advance 模块选做 |
| 第8周 | 测试优化 | 系统测试、性能优化 |
| 第9周 | 文档完善 | 文档编写、项目展示 |

## 联系方式

- **项目负责人**: [助教姓名]
- **技术支持**: [技术助教]
- **讨论群**: [QQ群/微信群]
- **项目仓库**: [GitHub链接]

---

**祝大家学习愉快，项目顺利！** 🚀